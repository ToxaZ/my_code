---
name: app_opened_android
query: 
    type: elastic
    q: NOT properties.app: fonoteka AND properties.os: android
    time_unit: month
    index: cs-app_opened*
--
name: app_opened_ios
query: 
    type: elastic
    q: "NOT properties.app: fonoteka AND properties.os: iOS"
    time_unit: month
    index: cs-app_opened*
---
name: trial
query:
    type: psql
    q: "select user_id, added from app_subscription where is_trial = true and app != 'fonoteka'"
---
name: subscription
query:
    type: psql
    q: "select user_id, added from app_subscription where is_trial = false and app != 'fonoteka'"
---
name: app_opened_query_android
query:
    type: elastic
    q: "NOT properties.app: fonoteka AND properties.os: android"
    time_unit: month"
    index: cs-app_opened*
---
name: app_opened_query_ios 
query:
    type: elastic
    q: "NOT properties.app: fonoteka AND properties.os: iOS"
    index: cs-app_opened*
    agg_field: app_instance
---
name: install_vmetro_query
query:
    type: elastic
    q: "properties.sub_site: vmetro"
    index: cs-mat_app_install*
    agg_field: app_instance
---
name: install_ios_query
query:
    type: elastic
    q: "properties.mat_app: 'Zvooq iOS'"
    index: cs-mat_app_install-2015.1*
    agg_field: app_instance
---
name: active_query_ai
query:
    type: elastic
    q: "NOT properties.app: fonoteka"
    index: cs-track_playback*
    agg_field: app_instance
---
name: active_query_android
query:
    type: elastic
    q: "NOT properties.app: fonoteka AND  properties.phoneType: android"
    index: cs-playevent*
---
name: active_query_ios
query:
    type: elastic
    q: "NOT properties.app: fonoteka AND  properties.phoneType: ios"
    index: cs-playevent*
---
name: app_open_vmetro_query
query:
    type: elastic
    q: "mat_info.sub_site:vmetro"
    index: cs-app_opened*
---
name: subscr_query
query:
    type: psql
    q: "select user_id from app_subscription where is_trial = false and price > 0 and app != 'fonoteka'"
---
name: genres_shown_query
query:
    type: elastic
    q: "features: NEW_GENRE_PAGE"
    index: cs-main_page_genres_shown*
---
name: web_users_query
query:
    type: elastic
    q: "properties.app:web AND NOT properties.utm-tags.utm_source:topt"
    index: cs-*
---
name: web_users_query_agg_by_cookie
query:
    type: elastic
    q: "properties.app:web AND NOT properties.utm-tags.utm_source:topt"
    index: cs-*
    time_unit: month
    agg_field: properties.user_cookie
---
name: active_10m_query
query:
    type: hive
    q: "select user_id from playevent group by user_id having sum(play_duration) >= 600"
---
name: mobile_pop_up_query
query:
    type: elastic
    q: "properties.type: pop-up"
    index: cs-mobile_shown*
---
name: mobile_pop_up_action_query
query:
    type: elastic
    q: "properties.type: pop-up"
    index: cs-mobile_link_requested*
---
name: app_open_version_query
query:
    type: elastic
    q: "properties.os: android AND properties.app_release: 1.9*"
    index: cs-app_opened*
    time_unit: year
    agg_field: app_instance
---
name: registration_query_agg_by_app_instance
query:
    type: elastic
    q: *
    index: cs-authentication_successful*
    agg_field: app_instance
---
name: registration_query_agg_by_user_cookie
query:
    type: elastic
    q: *
    index: cs-authentication_successful*
    time_unit: month
    agg_field: properties.user_cookie
---
name: app_registration_query_elastic
query:
    type: elastic
    q: "properties.os: android AND properties.app_release: 1.10*"
    index: cs-authentication_successful*
---
name: time_based_trial_query
query:
    type: psql
    q: "select user_id, added from app_subscription where is_trial = true and app != 'fonoteka'"
---
name: time_based_subscription_query
query:
    type: psql
    q: "select user_id, added from app_subscription where is_trial = false and app != 'fonoteka'"
